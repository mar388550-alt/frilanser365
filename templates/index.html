<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>WebSocket Messages</title>
    <style>
        body { font-family: Arial; padding: 20px; }
        #messages { list-style: none; padding: 0; max-width: 500px; }
        #messages li { padding: 8px; margin-bottom: 2px; background: #f0f0f0; border-radius: 4px; }
        #form { margin-bottom: 20px; }
        #input { width: 300px; padding: 8px; }
        button { padding: 8px 16px; }
    </style>
</head>
<body>
    <h1>WebSocket Chat с нумерацией</h1>

    <form id="form">
        <input type="text" id="input" placeholder="Введите сообщение" autocomplete="off">
        <button type="submit">Отправить</button>
    </form>

    <ul id="messages">
        <!-- Сюда будут добавляться сообщения -->
    </ul>

    <script>
        // Устанавливаем соединение по WebSocket
        const ws = new WebSocket(`ws://${window.location.host}/ws`);

        ws.onmessage = function(event) {
            const data = JSON.parse(event.data);
            const number = data.number;
            const message = data.message;
            const li = document.createElement('li');
            li.textContent = `${number}: ${message}`;
            document.getElementById('messages').appendChild(li);
        };

        ws.onclose = function() {
            console.log('Соединение закрыто');
        };

        ws.onerror = function(error) {
            console.error('Ошибка WebSocket:', error);
        };

        document.getElementById('form').addEventListener('submit', function(event) {
            event.preventDefault();
            const input = document.getElementById('input');
            const text = input.value.trim();
            if (text === '') return;
            const payload = JSON.stringify({ message: text });
            ws.send(payload);
            input.value = '';
        });
    </script>
</body>
</html>
