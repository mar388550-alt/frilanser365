<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>WebSocket Chat</title>
    <style>
        body { font-family: Arial; padding: 20px; }
        #messages { list-style: none; padding: 0; max-width: 500px; }
        #messages li { padding: 8px; margin-bottom: 2px; background: #f0f0f0; border-radius: 4px; }
        #form { margin-bottom: 20px; }
        #input { width: 300px; padding: 8px; }
        button { padding: 8px 16px; }
    </style>
</head>
<body>
    <h1>WebSocket Chat с нумерацией</h1>
    <form id="form">
        <input type="text" id="input" placeholder="Введите сообщение" autocomplete="off">
        <button type="submit">Отправить</button>
    </form>
    <ul id="messages"></ul>

    <script>
        // Используем wss:// для защищённого соединения (ваш сайт работает по HTTPS)
        const ws = new WebSocket(`wss://${window.location.host}/ws`);

        ws.onopen = () => console.log('WebSocket connected');
        ws.onerror = (err) => alert('WebSocket error: ' + err);
        ws.onmessage = (event) => {
            const data = JSON.parse(event.data);
            const li = document.createElement('li');
            li.textContent = `${data.number}: ${data.message}`;
            document.getElementById('messages').appendChild(li);
        };

        document.getElementById('form').onsubmit = (e) => {
            e.preventDefault();
            const input = document.getElementById('input');
            const text = input.value.trim();
            if (text) {
                ws.send(JSON.stringify({message: text}));
                input.value = '';
            }
        };
    </script>
</body>
</html>
